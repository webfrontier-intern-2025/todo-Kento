<!--
概要（処理の流れ）:
- ユーザーが TODO を追加/編集/削除・タグ付けできるインターフェース。
- ページ読み込み時に tags.js と todos.js がタグとTODOを取得して描画する想定。
- 追加時: 入力 -> 選択中のタグIDを収集 -> API 呼び出し（または localStorage 処理） -> リスト更新。
- 編集モーダル: 編集データをセットして表示 -> 更新/削除操作 -> リスト更新。
-->
{% extends "base.html" %}

{% block title %}TODO管理 - TODO App{% endblock %}

{% block extra_css %}
<!-- TODO専用CSS -->
<link rel="stylesheet" href="{{ url_for('static', path='/css/todos.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <h1>TODO管理</h1>

    <!-- Todo追加フォーム -->
    <div class="add-todo">
        <!-- 入力とボタンを先に配置 -->
        <div class="todo-input-wrapper">
            <input type="text" id="todoInput" placeholder="新しいTODOを入力...">
            <button id="addButton">TODO追加</button>
        </div>
        
        <!-- タグ選択エリア -->
        <div id="tagSelection" class="tag-selection">
            <!-- タグがここに表示されます（tags.js が描画） -->
        </div>
        
        <!-- クイックタグ追加 -->
        <div class="quick-tag-add">
            <input type="text" id="quickTagInput" placeholder="新しいタグを追加...">
            <input type="color" id="quickTagColor" value="#667eea" title="タグの色">
            <button id="quickAddTagButton">タグを追加</button>
        </div>
    </div>

    <!-- Todoリスト -->
    <ul id="todoList" class="todo-list">
        <!-- TODOがここに表示されます（todos.js が描画） -->
    </ul>
</div>

<!-- TODO編集モーダル（編集の流れ）:
     - edit ボタンで対象 TODO のデータとタグをモーダルにセットして表示
     - 更新ボタンで入力値を収集し API に送信（または local 処理） -> モーダルを閉じてリスト再描画
     - 削除ボタンは確認および API 呼び出し -> リスト再描画
-->
<div id="edit-todo-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close-todo-modal">&times;</span>
        <h2>TODOを編集</h2>
        <form id="edit-todo-form">
            <input type="hidden" id="edit-todo-id">
            <div class="form-group">
                <label for="edit-todo-content">内容</label>
                <input type="text" id="edit-todo-content" required>
            </div>
            <div class="form-group">
                <label>タグ</label>
                <div id="edit-tag-selection" class="tag-selection">
                    <!-- タグがここに表示されます（編集用、tags.js から流用） -->
                </div>
            </div>
            <div class="modal-buttons">
                <button type="submit" class="btn-primary">更新</button>
                <button type="button" class="btn-danger" id="delete-todo-in-modal">削除</button>
                <button type="button" class="btn-secondary" id="cancel-edit-todo">キャンセル</button>
            </div>
        </form>
    </div>
</div>

<script src="{{ url_for('static', path='/js/todos.js') }}"></script>
{% endblock %}